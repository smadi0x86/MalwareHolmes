package Malware.event_driven;

import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import java.io.IOException;
import Malware.object_oriented.MalwareAnalyzer; // Import the MalwareAnalyzer class from the object_oriented package to be used in the constructor of this class.
import Malware.object_oriented.SignatureIdentifier; // Import the SignatureIdentifier class from the object_oriented package to be used in the constructor of this class.

public class MalwareAnalyzerEventDriven extends MalwareAnalyzer {

    public MalwareAnalyzerEventDriven(SignatureIdentifier signatureIdentifier) {
        super(signatureIdentifier); // Call the constructor of the superclass (MalwareAnalyzer) and pass the SignatureIdentifier object to its constructor.
    }

    public void displayFileInput() {
        JFileChooser fileChooser = new JFileChooser();
        int option = fileChooser.showOpenDialog(null);

        if (option == JFileChooser.APPROVE_OPTION) {
            String filePath = fileChooser.getSelectedFile().getAbsolutePath();
            String result = null;

            try {
                result = analyzeFile(filePath);
            } catch (IOException e) {
                result = "Error caught: " + e.getMessage();
                System.out.println(result);
                e.printStackTrace();
            } catch (Exception e) {
                result = "Error caught: " + e.getMessage();
                System.out.println(result);
                e.printStackTrace();
            }

            JOptionPane.showMessageDialog(null, result, "Malware Analyzer", JOptionPane.INFORMATION_MESSAGE);

        } else if (option == JFileChooser.CANCEL_OPTION) {
            JOptionPane.showMessageDialog(null, "Bye Bye!", "Malware Analyzer", JOptionPane.INFORMATION_MESSAGE);
        }

    }
}