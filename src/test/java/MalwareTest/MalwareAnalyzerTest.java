package MalwareTest;

import org.junit.Test;

import Malware.logic.MalwareAnalyzer;
import Malware.logic.SignatureDatabase;
import Malware.logic.SignatureIdentifier;

import static org.junit.Assert.fail;

import java.io.IOException;
import java.security.NoSuchAlgorithmException;

public class MalwareAnalyzerTest {

    @Test
    public void testCalculateHash() {

        // Create an instance of SignatureDatabase (you may need to provide necessary dependencies or mock objects)
        SignatureDatabase signatureDatabase = new SignatureDatabase();
        // Create an instance of SignatureIdentifier (you may need to provide necessary dependencies or mock objects)
        SignatureIdentifier signatureIdentifier = new SignatureIdentifier(signatureDatabase);
        // Create an instance of MalwareAnalyzer with the SignatureIdentifier object
        MalwareAnalyzer malwareAnalyzer = new MalwareAnalyzer(signatureIdentifier);
        // Provide a test file path
        String filePath = "./src/main/java/Malware/object_oriented/test.txt";
        try {
            // Call the calculateHash method
            String hash = malwareAnalyzer.calculateHash(filePath);
            System.out.println(hash);

            // ! catch the exception thrown from the calculateHash method
        } catch (IOException | NoSuchAlgorithmException e) {
            // Handle any exceptions that may occur during the test
            fail("Test Error Catched: " + e.getMessage());
            e.printStackTrace();
        }
    }

    @Test
    public void testCompareHash() {

        SignatureDatabase SignatureDatabase = new SignatureDatabase();
        SignatureIdentifier SignatureIdentifier = new SignatureIdentifier(SignatureDatabase);
        MalwareAnalyzer MalwareAnalyzer = new MalwareAnalyzer(SignatureIdentifier);
        String filePath = "./src/main/java/Malware/object_oriented/test.txt";
        try {

            String hash = MalwareAnalyzer.calculateHash(filePath);
            System.out.println(hash);

        } catch (NoSuchAlgorithmException | IOException e) {
            fail("Test error catched: " + e.getMessage());
            e.printStackTrace();
        }

        SignatureIdentifier.compareHash(filePath);
    }

    // TODO: Add more test methods for other functionality of the MalwareAnalyzer class
}
