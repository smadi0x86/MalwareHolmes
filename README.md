<h1 align="center">
  <br>
  <a href="https://github.com/smadi0x86/MalwareHolmes"><img src="https://i.top4top.io/p_2698cd55g1.png" alt="malware.logo"></a>
  <br>
  MalwareHolmes üîé
  <br>
</h1>
<p align="center">
  <a href="">
<img src="https://img.shields.io/github/downloads/Yousinator/Math-For-Computing/total"> <img src ="https://img.shields.io/github/contributors/Yousinator/Math-For-Computing?color=dark-green"> <img src ="https://img.shields.io/github/forks/Yousinator/Math-For-Computing?style=social"> <img src ="https://img.shields.io/github/stars/Yousinator/Math-For-Computing?style=social"> <img src ="https://img.shields.io/github/license/Yousinator/Math-For-Computing">
  </a>
</p>

<h3 align="center">Built with ‚ù§Ô∏è</h3>

<p align="center">
  <a href="">
    <img src="https://img.shields.io/badge/apache_maven-C71A36?style=for-the-badge&logo=apachemaven&logoColor=white">
    <img src="https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white">
    <img src="https://img.shields.io/badge/-Language-blue?style=for-the-badge&logo=c">
    <img src="https://img.shields.io/badge/VScode-0078D4?style=for-the-badge&logo=visual%20studio%20code&logoColor=white">
    <img src="https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white">
    <img src="https://img.shields.io/badge/redis-%23DD0031.svg?style=for-the-badge&logo=redis&logoColor=white">
  </a>
  </p>

**The Malware Holmes is a Java project that performs static analysis on executable files to detect malicious behavior and potential security risks.**

**It leverages native code written in C to access low-level capabilities and enhance the analysis process.**

# ü§© Features

***The Malware Analyzer project offers the following features:***

- **Static Analysis**: The project performs static analysis on files to identify potential malware and security risks.
- **PE Analysis**: The project allows the analysis of Portable Executable (PE) files commonly found in Windows operating systems.
- **Signature-based Detection**: It utilizes a signature database to match known malware signatures and identify malicious files based on hash values.
- **Directory Monitoring**: The project provides a directory monitoring service that continuously scans a specified directory for new files and analyzes them in real-time.
- **Native Code Integration**: Native C code is integrated using Java Native Interface (JNI) to access low-level capabilities and perform advanced analysis techniques.
- **Logging**: Every file that is added to the monitored directory is logged onto an external txt file which is saved in the directory you ran the program from.

***Planned but not Implemented yet:***

- **Dynamic Analysis**: The project performs dynamic analysis on executable files to identify potential malware and security risks using different techniques such as API Hooking.
- **Container Protection:** The project runs dynamic analysis on executables in an isolated lightweight docker container which prevents any malware execution damage to your host machine.

# ü™ê Prerequisites

***In order to run this application, you will need the following:***

[Java Development Kit (JDK) version 8 or higher](https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html)

[Docker](https://www.docker.com/products/docker-desktop)

[Redis](https://redis.io/download)

***For development, the following tools are optional:***

[Apache Maven](https://maven.apache.org/download.cgi)

[MinGW gcc compiler](http://mingw-w64.org/doku.php/start)

[Visual Studio Code](https://code.visualstudio.com/download)

```
Please ensure these are installed and correctly set up before proceeding.
```

# üìù Usage

***Clone the repository:***

```bash
git clone https://github.com/smadi0x86/MalwareHolmes
```

***You have 2 choices for running this project either by using the pre-built version or manually building it.***

## Manual Build  

This command builds the project and packages it into a JAR file. The resulting JAR file can be found in the `/target` directory.

***Compiling native C code using gcc:***

**Move to maven-final-programming-quickpick/src/main/java/Malware/logic/peAnalysis directory on your terminal then run:**

```bash
gcc -I"C:\Program Files\Java\jdk-19\include" -I"C:\Program Files\Java\jdk-19\include\win32" -shared -o peAnalysis.dll peAnalysis.c pemetaData.c
```

**Move to maven-final-programming-quickpick/src/main/java/Malware/logic/staticAnalysis directory on your terminal then run:**

```bash
gcc -I"C:\Program Files\Java\jdk-19\include" -I"C:\Program Files\Java\jdk-19\include\win32" -shared -o staticAnalysis.dll staticAnalysis.c
```

***NOTE: Change path based on your jdk version, mine is jdk-19. After that move both dlls to Main.java directory.***

***Make sure to move the dll generated by the compiler to the same directory of the Main.java (The start of program).***

![image](https://github.com/smadi0x86/MalwareHolmes/assets/75253629/ad53b5f0-116f-4ba4-9529-5aef26bbe075)

***Now to build the project, navigate to the project directory and execute the following command:***

```bash
mvn clean package
```

***Pull and run the Redis Docker container:***

```bash
docker run --name some-redis -d -p 6379:6379 redis
```

**This will start a Redis instance on your local machine on port 6379.**

![image](https://github.com/smadi0x86/MalwareHolmes/assets/75253629/9b171aa8-1ad6-40f3-a355-643204fc83a5)

***After building the project, you can run it using the following command:***

```bash
java -Djava.library.path="{changeme}\maven-final-programming-quickpick\src\main\java" -jar target/maven-final-programming-quickpick-1.0-SNAPSHOT-jar-with-dependencies.jar
```

**You will be prompted to enter the path of the directory you want to monitor for malware.**

## Pre-built Version

**You can run the pre-built binary by installing it directly from the releases.**

***After downloading the pre-built binary, you can run it using the following command:***

```bash
java -Djava.library.path="{changeme}\maven-final-programming-quickpick\src\main\java" -jar target/maven-final-programming-quickpick-1.0-SNAPSHOT-jar-with-dependencies.jar
```

***IMPORTANT: When Specifying the library path (dlls) to run the program:***

```
If you saved the project in C drive it will be -Djava.library.path="C:\maven-final-programming-quickpick\src\main\java"
```
**So here we replaced the {changeme} with our C:\ Drive**

# ‚ôæÔ∏è Continuous Integration and Deployment (CI/CD)

**The Malware Analyzer project includes CI/CD pipelines for automated building, testing, and analysis. These pipelines are configured using GitHub Actions.**

### Unit Testing

The unit testing workflow is triggered on each push to the repository. It runs unit tests to ensure the correctness of the implemented methods.

### Maven Build

The Maven build workflow is triggered on each push to the repository. It performs the Maven build process for the project.

### CodeQL Analysis

The CodeQL analysis workflow is triggered on each push to the repository. It performs static analysis using CodeQL to identify security issues and potential vulnerabilities.

### Dependabot

Dependabot is configured to automate the creation of pull requests for any detected security issues or dependency updates. It ensures that your project stays up to date with the latest security patches and dependencies.

These CI/CD pipelines streamline the development process, automating tasks such as building, testing, and code analysis.

These pipelines enable continuous integration, automated testing, and code analysis, providing confidence in the project's stability and security.

# ü§ù Contributing

***Contributions to the Malware Analyzer project are welcome! If you would like to contribute, please follow these steps:***

- Fork the repository.
- Create a new branch for your feature or bug fix.
- Make your changes and commit them.
- Push your changes to your forked repository.
- Open a pull request, describing your changes and the motivation behind them.

# üìú License

This project is licensed under the [MIT LICENSE](https://github.com/smadi0x86/MalwareHolmes/blob/master/LICENSE)

# üìô References

http://www.pelib.com/examples.php
https://github.com/NtRaiseHardError/Dreadnought
https://gist.github.com/RachidAZ/d3c469cde5cf2498a451a7b9ba251b2d

# üìû Contact :

<p align="center">
<a href="https://linkedin.com/in/saud-smadi" target="blank"><img align="center" src="https://cdn.jsdelivr.net/npm/simple-icons@3.0.1/icons/linkedin.svg" alt="smadi" height="25" width="25" /></a>
<a href="https://twitter.com/@smadi0x86" target="blank"><img align="center" src="https://cdn.jsdelivr.net/npm/simple-icons@7.5.0/icons/twitter.svg" alt="smadi" height="25" width="25" /></a>
<a href="https://t.me/rootsmadi" target="blank"><img align="center" src="https://cdn.jsdelivr.net/npm/simple-icons@3.0.1/icons/telegram.svg" alt="smadi" height="25" width="25" /></a>
<a href="https://smadi0x86-blog.gitbook.io/smadi0x86-blog/" target="blank"><img align="center" src="https://cdn.jsdelivr.net/npm/simple-icons@7.5.0/icons/gitbook.svg" alt="smadi" height="25" width="25" /></a>
</p>
